kaboom({canvas:document.querySelector("#game"),width:960,height:720,background:[169,235,255],font:"apl386o"}),loadRoot("https://raw.githubusercontent.com/AronMoss/mw/main/assets/"),loadSprite("bg","sprites/bg-winter.png"),loadSprite("bg-gingerbread","sprites/bg-gingerbread.png"),loadSprite("lady-elf","sprites/lady-elf.svg"),loadSprite("arrow","sprites/arrow.png");const draggableSprites=[{name:"gingerbread-house.svg",scale:1.5},{name:"ball-a.svg",scale:10},{name:"ball-b.svg",scale:1},{name:"ball-c.svg",scale:1},{name:"ball-d.svg",scale:1},{name:"ball-e.svg",scale:1},{name:"candy1.png",scale:1},{name:"candy1.png",scale:1},{name:"candy2.svg",scale:.5},{name:"snowflake.svg",scale:.3},{name:"snowflake.svg",scale:.3},{name:"door.png",scale:1},{name:"window.png",scale:1}];draggableSprites.map(e=>loadSprite(e.name,`sprites/${e.name}`));const soundNames=["game","gingerbread","click","spin","correct","wrong","win","lose"];soundNames.map(e=>loadSound(e,`sounds/${e}.mp3`)),volume(.5);const WHEEL_RADIUS=160;let correctAnswersNum=0,wrongAnswersNum=0,answersNum=4,factor1=0,factor2=0,products=[];scene("game",()=>{const e=play("game",{loop:!0,volume:.05});factor1>12&&(factor1=0),factor2=0,correctAnswersNum=0,wrongAnswersNum=0,gravity(1500),add([sprite("bg")]);const t=add([sprite("lady-elf"),pos(250,150),origin("center"),scale(1),area(),body(),color(255,255,255),function(e=1){let t=!1;return{id:"funky",require:["scale","color"],update(){t&&(this.color=rgb(rand(0,255),rand(0,255),rand(0,255)),this.scale=rand(1,1.5))},getFunky(){t=!0,wait(e,()=>{t=!1,this.color=rgb(255,255,255),this.scale=1})}}}(1)]),o=addButton({txt:"Spin",p:vec2(width()/2,550)},()=>{n.isSpinning()?function(){g.pause(),o.text("Spin"),factor2=n.stopSpinning(),function(){products=[];for(;products.length<answersNum;){let e=randi(1,12)*factor1;products.includes(e)||products.push(e)}const e=factor1*factor2;products.includes(e)||products.splice(randi(0,3),1,e)}();for(let e=0;e<answersNum;e++)wait(.05*(e+1),()=>{i[e].text(products[e].toString()),i[e].show()});a[factor2-1].color=rgb(255,0,0),o.hide(),r.text("Select an answer!"),r.show()}():function(){g=play("spin",{loop:!0});for(let e=0;e<answersNum;e++)i[e].hide();for(let e=0;e<a.length;e++)a[e].color=rgb(0,0,0),a[e].outline=2;(factor1+=1)>12&&(factor1=0);c.text=`${factor1}x`,r.hide(),o.text("Stop"),n.spin()}()}),r=addInfoText({p:vec2(width()/2,660)});r.text("Click Spin to play");const s=add([circle(WHEEL_RADIUS),pos(width()/2,height()/2-30),outline(2),color(127,200,255)]);for(let e=0;e<6;e++)add([pos(s.pos),rect(2,320),color(0,0,0),origin("center"),rotate(15+30*e)]);let a=[];for(let e=1;e<=12;e++){const t=add([text(`${e}`,{size:30,font:"apl386"}),pos(u(e)),origin("center"),color(0,0,0)]);a.push(t)}const n=add([sprite("arrow"),pos(s.pos),origin("bot"),rotate(0),function(){let e=!1,t=0;return{id:"spin",update(){e&&(t+=80*dt())>3&&(this.angle+=30,t=0)},spin(){this.angle=0,t=0,e=!0},stopSpinning(){return e=!1,this.angle%360/30+1},isSpinning:()=>e}}()]);add([circle(42),pos(s.pos),outline(2),color(7,200,255)]);const c=add([text(`${0===factor1?1:factor1}x`,{size:40,font:"apl386"}),pos(s.pos),origin("center"),color(255,0,0)]);let i=[];for(let e=0;e<answersNum;e++){const t=width()/2-120+80*e,o=rgb(7,200,95),r={w:60,h:40},s=addButton({txt:`${e}`,p:vec2(t,100),size:r,bgColor:o},()=>{p(e)});s.hide(),i.push(s)}const l=add([text(""),pos(20,20),color(50,250,50)]),d=add([text(""),pos(20,85),color(255,0,0)]);function p(s){for(let e=0;e<answersNum;e++)i[e].hide();if(factor1*factor2===products[s]){play("correct");const s=randi(1,3);1===s?(t.getFunky(),r.text("You Rock!")):2===s?(t.jump(),r.text("Awesome!")):r.text("Great Job!"),correctAnswersNum+=1,l.text=correctAnswersNum.toString(),correctAnswersNum-wrongAnswersNum>=3?(e.pause(),wait(1,()=>{go("reward")})):o.show()}else play("wrong"),r.text("Oops, try again!"),wrongAnswersNum+=1,d.text=wrongAnswersNum.toString(),shake(12),wrongAnswersNum>=3?(e.pause(),play("lose",{volume:.3}),wait(1,()=>{go("lose")})):o.show()}let g=null;function u(e){const t=deg2rad(30*e-120);let o=Math.cos(t)*WHEEL_RADIUS,r=Math.sin(t)*WHEEL_RADIUS;return o=s.pos.x+.85*o,r=s.pos.y+.85*r,vec2(o,r)}}),scene("reward",()=>{const e=play("gingerbread",{loop:!0,volume:.05});add([sprite("bg-gingerbread")]);let t=!1;const o=addButton({txt:"Start",p:vec2(width()/2,350)},()=>{!function(){r.hide(),o.hide();for(let e=0;e<8;e++){const t=50,o=10+80*e;let r=add([sprite(draggableSprites[e].name),scale(draggableSprites[e].scale),pos(t,o),origin("center"),area(),a()]);0===e&&(r.pos=vec2(width()/2,530))}for(let e=8;e<draggableSprites.length;e++){const t=width()-60,o=120+120*(e-8);add([sprite(draggableSprites[e].name),scale(draggableSprites[e].scale),pos(t,o),origin("center"),area(),a()])}addButton({txt:"Back",p:vec2(100,50)},()=>{e.pause(),go("game")}).show(),t=!0}()});add([sprite("lady-elf"),pos(250,485),origin("center"),area(),a()]);const r=addInfoText({p:vec2(width()/2,600)});r.text("Hooray! You can now decorate\nyour gingerbread house!");let s=null;function a(){let e=vec2(0);return{id:"drag",require:["pos","area"],add(){this.onClick(()=>{t&&!s&&(s=this,e=mousePos().sub(this.pos),readd(this))})},update(){t&&s===this&&(cursor("move"),this.pos=mousePos().sub(e))}}}onMouseRelease(()=>{s=null}),onUpdate(()=>{s||cursor("default")})}),scene("lose",()=>{add([sprite("bg")]),addInfoText({p:center(),bgColor:rgb(255,100,125)}).text("You Lose! Try again."),addButton({txt:"Play",p:vec2(width()/2,500)},()=>{go("game")})}),go("reward");